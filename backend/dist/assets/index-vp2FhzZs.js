(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))n(e);new MutationObserver(e=>{for(const r of e)if(r.type==="childList")for(const u of r.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&n(u)}).observe(document,{childList:!0,subtree:!0});function c(e){const r={};return e.integrity&&(r.integrity=e.integrity),e.referrerPolicy&&(r.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?r.credentials="include":e.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(e){if(e.ep)return;e.ep=!0;const r=c(e);fetch(e.href,r)}})();var l={};const i=require("express");require("dotenv").config();const f=require("cors"),{mongoose:a}=require("mongoose"),d=require("cookie-parser");require("body-parser");const p=require("jsonwebtoken");a.connect(l.MONGO_URL).then(()=>console.log("Datebase Connnected.")).catch(t=>console.log("Some Error While connecting",t));const o=i();o.use(i.json());o.use(d());o.use(i.urlencoded({extended:!1}));o.use(i.static("Public"));o.use(f({methods:["GET","POST","PUT","DELETE"],credentials:!0,origin:"http://localhost:5173"}));o.use("/",require("./routes/authRoutes"));o.use("/",require("./routes/empRoutes"));const g=(t,s,c)=>{const n=t.cookies.token;n?p.verify(n,l.JWT_SECRET,(e,r)=>{if(e)return s.json({Status:!1,Error:"Wrong Token"});t.id=r.id,t.role=r.role,c()}):s.json({Status:!1,Error:"Not Authenticated"})};o.get("/verify",g,(t,s)=>s.json({Status:!0,role:t.role,id:t.id}));o.listen(8e3,()=>{console.log("Listening at port 8000")});
